var doc=null,obj=null,XMLTools=function(e){"string"==typeof e&&(doc=Ti.XML.parseString(e).documentElement),"object"==typeof e&&(doc=e.documentElement)};XMLTools.prototype.getDocument=function(){return doc};var addToObject=function(e,a,t){if(null==e[a])e[a]=t;else if(e[a]instanceof Array)e[a].push(t);else{var i=e[a],r=[i,t];e[a]=r}return e},traverseTree=function(e){var a=!0,t={};if(e.hasChildNodes()){for(var i=0;e.childNodes.length>i;i++){var r=e.childNodes.item(i);if("#text"!=r.nodeName||""!=r.textContent.replace(/\n/g,"").replace(/ /g,""))if(3===r.nodeType||r.nodeType===r.CDATA_SECTION_NODE){if(1===e.childNodes.length&&!e.hasAttributes())return r.textContent;t.text=r.textContent}else t=addToObject(t,r.tagName,traverseTree(r))}a=!1}if(e.hasAttributes()){for(var n=0;e.attributes.length>n;n++){var o=e.attributes.item(n);t[o.nodeName]=o.nodeValue}a=!1}return t};XMLTools.prototype.toObject=function(){return null==doc?null:obj=traverseTree(doc)},XMLTools.prototype.toJSON=function(){return null==doc?null:(null==obj&&(obj=traverseTree(doc)),JSON.stringify(obj))},module.exports=XMLTools;